<div class="buyer-visits-list">

  <div *ngIf="loading" class="loading-state">
    <div class="spinner"></div>
    <p>Cargando visitas...</p>
  </div>

  <div *ngIf="error" class="error-state">
    <i class="material-icons">error</i>
    <p>Error al cargar las visitas. Por favor, intente nuevamente.</p>
    <button (click)="loadVisits()" class="retry-button">
      Reintentar
    </button>
  </div>

  <div *ngIf="!loading && !error && visits.length === 0" class="empty-state">
    <i class="material-icons">event_busy</i>
    <p *ngIf="userType === 'buyer'">No tienes visitas programadas</p>
    <p *ngIf="userType === 'seller'">No tienes visitas agendadas para tus propiedades</p>
  </div>

  <div *ngIf="!loading && !error && visits.length > 0" class="visits-container">
    <div *ngFor="let visit of visits" class="visit-card">
      <div class="visit-header">
        <h3 class="property-name">
          <span *ngIf="userType === 'buyer'">Visita Programada</span>
          <span *ngIf="userType === 'seller'">Visita Agendada - Propiedad #{{visit.scheduleId}}</span>
        </h3>
        <div *ngIf="userType === 'seller'" class="visit-status">
          <span class="status-badge status-pending">Pendiente de Confirmaci√≥n</span>
        </div>
      </div>

      <div *ngIf="userType === 'seller'" class="visit-summary">
        <p class="summary-text">Un comprador ha solicitado visitar tu propiedad</p>
      </div>

      <div class="visit-details">
        <div class="detail-item">
          <i class="material-icons">event</i>
          <span>{{visit.startDate | date:'EEEE d MMMM, y'}}</span>
        </div>
        <div class="detail-item">
          <i class="material-icons">schedule</i>
          <span>{{visit.startDate | date:'h:mm a'}} - {{visit.endDate | date:'h:mm a'}}</span>
        </div>
        <div class="detail-item">
          <i class="material-icons">email</i>
          <span *ngIf="userType === 'buyer'">{{visit.buyerEmail}}</span>
          <span *ngIf="userType === 'seller'">Comprador: {{visit.buyerEmail}}</span>
        </div>
        <div *ngIf="userType === 'seller'" class="detail-item">
          <i class="material-icons">access_time</i>
          <span>Solicitada: {{visit.timestamp | date:'dd/MM/yyyy h:mm a'}}</span>
        </div>
        <div *ngIf="userType === 'seller'" class="detail-item">
          <i class="material-icons">info</i>
          <span>ID de Visita: #{{visit.id}}</span>
        </div>
      </div>

      <div class="visit-actions">
        <button class="cancel-button" (click)="cancelVisit(visit.id)">
          <span *ngIf="userType === 'buyer'">Cancelar visita</span>
          <span *ngIf="userType === 'seller'">Rechazar visita</span>
        </button>
        <button *ngIf="userType === 'seller'" class="confirm-button" (click)="confirmVisit(visit.id)">
          Confirmar visita
        </button>
      </div>
    </div>
  </div>
</div> 